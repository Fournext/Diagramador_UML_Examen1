<div class="side-panel">

  <div
    class="palette-item"
    cdkDrag
    [cdkDragData]="{ type: 'class' }"
    (cdkDragEnded)="onDragEnded($event)">
    <div class="item-content">📦 Clase UML</div>
  </div>

  <div
    class="palette-item"
    cdkDrag
    [cdkDragData]="{ type: 'association' }"
    (cdkDragEnded)="onDragEnded($event)">
    <div class="item-content">🔗 Asociación</div>
  </div>

  <div
    class="palette-item"
    cdkDrag
    [cdkDragData]="{ type: 'generalization' }"
    (cdkDragEnded)="onDragEnded($event)">
    <div class="item-content">⬆️ Herencia</div>
  </div>

  <div
    class="palette-item"
    cdkDrag
    [cdkDragData]="{ type: 'aggregation' }"
    (cdkDragEnded)="onDragEnded($event)">
    <div class="item-content">◇ Agregación</div>
  </div>

  <div
    class="palette-item"
    cdkDrag
    [cdkDragData]="{ type: 'composition' }"
    (cdkDragEnded)="onDragEnded($event)">
    <div class="item-content">◆ Composición</div>
  </div>

  <div
    class="palette-item"
    cdkDrag
    [cdkDragData]="{ type: 'dependency' }"
    (cdkDragEnded)="onDragEnded($event)">
    <div class="item-content">⋯ Dependencia</div>
  </div>

  <button class="save-btn" (click)="onSaveClicked()">💾 Guardar</button>

  <!-- Chatbot panel -->
  <div class="chatbot-panel">
    <h4>🤖 Generar modelo</h4>
    <textarea [(ngModel)]="prompt"
              placeholder="Describe tu modelo aquí..."
              rows="4"></textarea>
    <button class="generate-btn" (click)="onGenerate()">Generar</button>
  </div>

   <!-- Panel de validaciones -->
  <div class="validation-panel">
    <div class="validation-header" (click)="toggleValidationPanel()">
      <h4>🔍 Sugerencias del modelo</h4>
      <span>{{ validationCollapsed ? '➕' : '➖' }}</span>
    </div>
    <button (click)="analyzeNow()">🔍 Analizar modelo</button>
    <div *ngIf="!validationCollapsed" class="validation-content">
      <div *ngIf="!validationResult">
        <p>No hay validaciones aún.</p>
      </div>

      <div *ngIf="validationResult">
        <!-- Validas -->
        <h5>✅ Relaciones válidas</h5>
        <ul>
          <li *ngFor="let v of validationResult.analysis.validas">
            <strong>{{ v.relacion }}</strong><br />
            <small>{{ v.razon }}</small>
          </li>
        </ul>

        <!-- Errores -->
        <h5>❌ Errores</h5>
        <ul>
          <li *ngFor="let e of validationResult.analysis.errores">
            <strong>{{ e.relacion }}</strong><br />
            <small>{{ e.problema }}</small><br />
            <em>Sugerencia: {{ e.sugerencia }}</em>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>
